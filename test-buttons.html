<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –∫–Ω–æ–ø–æ–∫</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f0f0f0;
        }
        
        .test-container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .test-button {
            display: block;
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid #007bff;
            border-radius: 8px;
            background: #007bff;
            color: white;
            font-size: 16px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .test-button:hover {
            background: #0056b3;
            border-color: #0056b3;
            transform: translateY(-2px);
        }
        
        .test-button:active {
            transform: translateY(0);
        }
        
        .test-button.action-button {
            background: #28a745;
            border-color: #28a745;
        }
        
        .test-button.action-button:hover {
            background: #1e7e34;
            border-color: #1e7e34;
        }
        
        .test-button.location-button {
            background: #ffc107;
            border-color: #ffc107;
            color: #212529;
        }
        
        .test-button.location-button:hover {
            background: #e0a800;
            border-color: #e0a800;
        }
        
        .log {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            margin-top: 20px;
            font-family: monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .platform-info {
            background: #e9ecef;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        
        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-weight: bold;
        }
        
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status.warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üß™ –¢–µ—Å—Ç –∫–Ω–æ–ø–æ–∫ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º</h1>
        
        <div class="platform-info">
            <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ:</h3>
            <div id="platform-details"></div>
        </div>
        
        <div id="status-container"></div>
        
        <h3>–¢–µ—Å—Ç–æ–≤—ã–µ –∫–Ω–æ–ø–∫–∏:</h3>
        
        <button class="test-button action-button" data-action="test-action-1">
            üéØ –¢–µ—Å—Ç–æ–≤–∞—è –∫–Ω–æ–ø–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è 1
        </button>
        
        <button class="test-button action-button" data-action="test-action-2">
            üéØ –¢–µ—Å—Ç–æ–≤–∞—è –∫–Ω–æ–ø–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è 2
        </button>
        
        <button class="test-button location-button" data-location="test-location-1">
            üó∫Ô∏è –¢–µ—Å—Ç–æ–≤–∞—è –∫–Ω–æ–ø–∫–∞ –ª–æ–∫–∞—Ü–∏–∏ 1
        </button>
        
        <button class="test-button location-button" data-location="test-location-2">
            üó∫Ô∏è –¢–µ—Å—Ç–æ–≤–∞—è –∫–Ω–æ–ø–∫–∞ –ª–æ–∫–∞—Ü–∏–∏ 2
        </button>
        
        <h3>–õ–æ–≥ —Å–æ–±—ã—Ç–∏–π:</h3>
        <div id="event-log" class="log"></div>
        
        <button id="clear-log" style="margin-top: 10px; padding: 10px 20px; background: #6c757d; color: white; border: none; border-radius: 5px; cursor: pointer;">
            –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥
        </button>
    </div>

    <script>
        class ButtonTester {
            constructor() {
                this.eventLog = [];
                this.platformInfo = this.detectPlatform();
                this.init();
            }
            
            detectPlatform() {
                const userAgent = navigator.userAgent;
                const isTelegramWebApp = !!window.Telegram?.WebApp;
                const isMobile = /Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(userAgent);
                const isDesktop = !isMobile;
                const isTelegramDesktop = isTelegramWebApp && isDesktop;
                
                return {
                    userAgent,
                    isTelegramWebApp,
                    isMobile,
                    isDesktop,
                    isTelegramDesktop,
                    platform: isTelegramDesktop ? 'Telegram Desktop' : 
                              isTelegramWebApp ? 'Telegram Mobile' : 
                              isMobile ? 'Mobile Browser' : 'Desktop Browser'
                };
            }
            
            init() {
                this.displayPlatformInfo();
                this.setupEventHandlers();
                this.log('–°–∏—Å—Ç–µ–º–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞');
                this.updateStatus();
            }
            
            displayPlatformInfo() {
                const details = document.getElementById('platform-details');
                details.innerHTML = `
                    <p><strong>–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:</strong> ${this.platformInfo.platform}</p>
                    <p><strong>User Agent:</strong> ${this.platformInfo.userAgent}</p>
                    <p><strong>Telegram WebApp:</strong> ${this.platformInfo.isTelegramWebApp ? '–î–∞' : '–ù–µ—Ç'}</p>
                    <p><strong>–ú–æ–±–∏–ª—å–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ:</strong> ${this.platformInfo.isMobile ? '–î–∞' : '–ù–µ—Ç'}</p>
                    <p><strong>–î–µ—Å–∫—Ç–æ–ø:</strong> ${this.platformInfo.isDesktop ? '–î–∞' : '–ù–µ—Ç'}</p>
                `;
            }
            
            setupEventHandlers() {
                const actionButtons = document.querySelectorAll('.action-button');
                const locationButtons = document.querySelectorAll('.location-button');
                
                // Setup action buttons
                actionButtons.forEach(button => {
                    const actionId = button.dataset.action;
                    this.setupButtonEvents(button, 'action', actionId);
                });
                
                // Setup location buttons
                locationButtons.forEach(button => {
                    const locationId = button.dataset.location;
                    this.setupButtonEvents(button, 'location', locationId);
                });
                
                // Clear log button
                document.getElementById('clear-log').addEventListener('click', () => {
                    this.clearLog();
                });
            }
            
            setupButtonEvents(button, type, id) {
                const eventTypes = ['click', 'mousedown', 'mouseup', 'touchstart', 'touchend', 'pointerdown', 'pointerup'];
                
                eventTypes.forEach(eventType => {
                    button.addEventListener(eventType, (e) => {
                        this.handleButtonEvent(e, button, type, id);
                    }, { capture: true, passive: false });
                });
                
                // Also set onclick as fallback
                button.onclick = (e) => {
                    this.handleButtonEvent(e, button, type, id);
                };
                
                // Force button to be interactive
                button.style.pointerEvents = 'auto';
                button.style.cursor = 'pointer';
                button.style.display = 'block';
                button.style.visibility = 'visible';
                button.style.opacity = '1';
            }
            
            handleButtonEvent(event, button, type, id) {
                event.preventDefault();
                event.stopPropagation();
                
                const eventInfo = {
                    type: type,
                    id: id,
                    eventType: event.type,
                    timestamp: new Date().toISOString(),
                    button: button.textContent.trim(),
                    coordinates: {
                        clientX: event.clientX,
                        clientY: event.clientY
                    }
                };
                
                this.log(`üéØ ${type.toUpperCase()} –∫–Ω–æ–ø–∫–∞ "${id}" - —Å–æ–±—ã—Ç–∏–µ: ${event.type}`, eventInfo);
                
                // Simulate action
                if (type === 'action') {
                    this.simulateAction(id);
                } else if (type === 'location') {
                    this.simulateLocationMove(id);
                }
                
                // Visual feedback
                button.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    button.style.transform = '';
                }, 150);
            }
            
            simulateAction(actionId) {
                this.log(`‚úÖ –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–µ–π—Å—Ç–≤–∏–µ: ${actionId}`);
                // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ä–µ–∞–ª—å–Ω—É—é –ª–æ–≥–∏–∫—É
            }
            
            simulateLocationMove(locationId) {
                this.log(`‚úÖ –ü–µ—Ä–µ—Ö–æ–¥ –≤ –ª–æ–∫–∞—Ü–∏—é: ${locationId}`);
                // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ä–µ–∞–ª—å–Ω—É—é –ª–æ–≥–∏–∫—É
            }
            
            log(message, data = null) {
                const timestamp = new Date().toLocaleTimeString();
                const logEntry = `[${timestamp}] ${message}`;
                
                this.eventLog.push({ message: logEntry, data, timestamp });
                
                const logElement = document.getElementById('event-log');
                const logLine = document.createElement('div');
                logLine.textContent = logEntry;
                logElement.appendChild(logLine);
                
                // Auto-scroll to bottom
                logElement.scrollTop = logElement.scrollHeight;
                
                // Keep only last 50 entries
                if (this.eventLog.length > 50) {
                    this.eventLog.shift();
                    if (logElement.firstChild) {
                        logElement.removeChild(logElement.firstChild);
                    }
                }
                
                console.log(message, data);
            }
            
            clearLog() {
                this.eventLog = [];
                document.getElementById('event-log').innerHTML = '';
                this.log('–õ–æ–≥ –æ—á–∏—â–µ–Ω');
            }
            
            updateStatus() {
                const container = document.getElementById('status-container');
                let statusClass = 'success';
                let statusMessage = '–í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ';
                
                if (this.platformInfo.isTelegramDesktop) {
                    statusClass = 'warning';
                    statusMessage = '–û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –¥–µ—Å–∫—Ç–æ–ø–Ω–∞—è –≤–µ—Ä—Å–∏—è Telegram - –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è';
                } else if (this.platformInfo.isTelegramWebApp) {
                    statusClass = 'success';
                    statusMessage = '–û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –º–æ–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è Telegram - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞';
                }
                
                container.innerHTML = `<div class="status ${statusClass}">${statusMessage}</div>`;
            }
        }
        
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', () => {
            new ButtonTester();
        });
    </script>
</body>
</html>
